{{ define "title" }}{{ .Site.Title }} &ndash; {{ .Title }}{{ end }}
{{ define "main" }}
<section class="bolt-header">
    <div class="wrapper py-20">
      <h1 class="text--white">{{ .Title }}</h1>
  </div>
</section>
{{ $section := .Site.GetPage "section" .Section }}
<div class="wrapper py-20" data-kind="{{ .Kind }}">
    <header class="breadcrumbs">
        <a href="/docs/">Docs</a> &gt;
        <a href="/docs/alerts/">Alerts</a>
    </header>
    <main class="post-content flex pt-10 on-sm-stack">
      <section class="col-1-3 mr-30 mb-30">
        <table class="bordered">
          <thead>
            <tr>
              <th colspan="2">
                Details
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <strong>Alert ID</strong>
              </td>
              <td>{{ .Params.alertid }}</td>
            </tr>
            <tr> 
              <td>
                <strong>Alert Type</strong>
              </td>
              <td>{{ .Params.alerttype }}</td>
            </tr>
            <tr> 
              <td>
                <strong>Status</strong>
              </td>
              <td>{{ .Params.status }}</td>
            </tr>
            <tr> 
              <td>
                <strong>
                  Risk
                </td>
              <td>{{ .Params.risk }}</td>
            </tr>
            <tr> 
              <td>
                <strong>CWE</strong>
              </td>
              <td>
                <a href="https://cwe.mitre.org/data/definitions/{{ .Params.cwe }}.html">
                  {{ .Params.cwe }}
                </a>
              </td>
            </tr>
            <tr> 
              <td>
                <strong>WASC</strong>
              </td>
              <td>{{ .Params.wasc }}</td>
            </tr>
            <tr> 
              <td>
                <strong>Technologies Targeted</strong>
              </td>
              <td>
              {{ if isset .Params "techtags" }}
                {{ range $tag := .Params.techtags }}
                	<a href="/techtags/{{ lower $tag }}">{{ replace (replace $tag "_" " ") "." " / " }}</a><br>
                {{ end }}
              {{ else }}
                All
              {{ end }}
	          </td>
            </tr>
            <tr> 
              <td>
                <strong>Tags</strong>
              </td>
              <td>
              {{ range $tag := .Params.alerttags }}
              	<a href="/alerttags/{{ lower $tag }}">{{ upper $tag }}</a><br>
              {{ end }}
              </td>
            </tr>
            {{ if isset .Params "help" }}
            <tr> 
              <td>
                <strong>More Info</strong>
              </td>
              <td>
              	<a href="{{ .Params.help  }}">Scan Rule Help</a><br>
              </td>
            </tr>
            {{ end }}
          </tbody>
        </table>

      </section>
      <section class="col-2-3">
        <div data-attr="summary">
          <h3 class="mb-10">Summary</h3>
          {{ .Content }}
        </div>
        <div data-attr="solution" class="mb-20">
          <h3 class="mb-10">Solution</h3>
          {{ .Params.solution }}
        </div>
        <div data-attr="other" class="mb-20">
          <h3 class="mb-10">Other Info</h3>
          {{ .Params.other }}
        </div>
        <h3 class="mb-10">References</h3>
        <ul data-attr="references">
        {{ range .Params.references }}
          <li>
            {{ if hasPrefix . "http" }}
              <a href="{{ . }}">{{ . }}</a>
            {{ else }}
              {{ . }}
            {{ end }}
          </li>
        {{ end }}
        </ul>
        <h4 class="mb-10">Code</h4>
          <a href='{{ .Params.code  }}'>{{ .Params.linktext }}</a>
      </section>
  </main>
</div>
{{ end }}

