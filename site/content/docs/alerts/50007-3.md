---
title: "GraphQL Circular Type Reference"
alertid: 50007-3
alertindex: 5000703
alerttype: "Tool"
alertcount: 3
status: alpha
type: alert
risk: Informational
solution: "Consider restructuring the schema to avoid circular references. Use IDs or foreign keys instead of direct object references. Enforce query depth limits and use pagination to control deep nested queries."
references:
   - https://cheatsheetseries.owasp.org/cheatsheets/GraphQL_Cheat_Sheet.html#dos-prevention
other: "Query -> (Organization -> Repository -> PullRequest -> Commit -> Organization)"
cwe: 16
wasc: 15
alerttags: 
  - CWE-16
  - OWASP_2021_A04
  - OWASP_2023_API4
  - WSTG-v42-APIT-01
code: https://github.com/zaproxy/zap-extensions/blob/main/addOns/graphql/src/main/java/org/zaproxy/addon/graphql/ExtensionGraphQl.java
linktext: "org/zaproxy/addon/graphql/ExtensionGraphQl.java"
help: https://www.zaproxy.org/docs/desktop/addons/graphql-support/alerts/#id-50007
---
A circular reference was detected in the GraphQL schema, where object types reference each other in a cycle. This can be exploited by attackers to craft deeply recursive queries, potentially leading to Denial of Service (DoS) conditions.
