---
title: "Loosely Scoped Cookie"
alertid: 90033
alerttype: "Passive Scan Rule"
status: release
type: alert
date: 2020-04-30 09:48:11.442Z
lastmod: 2020-04-30 09:48:11.442Z
---
### Type: Passive Scan

### Description
Cookies can be scoped by domain or path. This check is only concerned with domain scope.The domain scope applied to a cookie determines which domains can access it. For example, a cookie can be scoped strictly to a subdomain e.g. www.nottrusted.com, or loosely scoped to a parent domain e.g. nottrusted.com. In the latter case, any subdomain of nottrusted.com can access the cookie. Loosely scoped cookies are common in mega-applications like google.com and live.com. Cookies set from a subdomain like app.foo.bar are transmitted only to that domain by the browser. However, cookies scoped to a parent-level domain may be transmitted to the parent, or any subdomain of the parent.

### Solution

Always scope cookies to a FQDN (Fully Qualified Domain Name).

### References

* https://tools.ietf.org/html/rfc6265#section-4.1
* https://www.owasp.org/index.php/Testing_for_cookies_attributes_(OTG-SESS-002)
* http://code.google.com/p/browsersec/wiki/Part2#Same-origin_policy_for_cookies

### Code

 * [org/zaproxy/zap/extension/pscanrules/CookieLooselyScopedScanner.java](https://github.com/zaproxy/zap-extensions/blob/master/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/CookieLooselyScopedScanner.java)

###### Last updated: 2020-04-30 09:48:11.442Z
